<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>P&K Store - MLBB Diamond Top-Up</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://i.ibb.co/TxRTR7gK/Screenshot-2025-07-02-093146.png">
  <style>
    :root {
      --mlbb-red: #FF4655;
      --mlbb-gold: #FFD700;
      --mlbb-dark: #1A1A2E;
      --whatsapp-green: #25D366;
      --diamond-blue: #00B4D8;
      --bonus-green: #2ECC71;
      --success-green: #2ecc71;
      --error-red: #e74c3c;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      color: white;
      margin: 0;
      padding: 0;
      line-height: 1.6;
      background: 
        linear-gradient(rgba(26, 26, 46, 0.85), rgba(22, 33, 62, 0.85)),
        url('https://i.ibb.co/gZmG5qGH/f06d748d5aa3faea03ec608af62ed6d2.jpg') no-repeat center center fixed;
      background-size: cover;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: rgba(26, 26, 46, 0.7);
      backdrop-filter: blur(5px);
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0,0,0,0.5);
    }
    
    .logo-container {
      text-align: center;
      margin-bottom: 10px;
    }
    
    .logo-img {
      max-width: 180px;
      height: auto;
      border-radius: 12px;
      border: 2px solid var(--mlbb-gold);
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
    }
    
    .store-title {
      text-align: center;
      font-size: 2.5rem;
      color: var(--mlbb-gold);
      margin: 0 0 20px 0;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--mlbb-red);
    }
    
    /* Auth Section Styles */
    #auth-section {
      text-align: right;
      margin: 10px 20px;
    }
    
    #auth-btn, #logout-btn {
      background: var(--mlbb-red);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    #logout-btn {
      background: var(--mlbb-dark);
      border: 1px solid var(--mlbb-gold);
      margin-left: 10px;
    }
    
    #auth-btn:hover, #logout-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }
    
    #user-profile {
      display: none;
    }
    
    #username-display {
      color: var(--mlbb-gold);
      font-weight: bold;
    }
    
    /* Rest of your existing styles... */
    .payment-info {
      background: rgba(0,0,0,0.3);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      border: 2px solid var(--mlbb-gold);
      box-shadow: 0 0 15px rgba(255,215,0,0.2);
    }
    
    .payment-header {
      color: var(--mlbb-gold);
      font-size: 22px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .payment-header img {
      width: 30px;
      margin-right: 10px;
    }
    
    .upi-container {
      background: rgba(255,255,255,0.1);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }
    
    .upi-id {
      font-size: 18px;
      font-weight: bold;
      color: white;
      margin: 10px 0;
      word-break: break-all;
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border-radius: 6px;
      font-family: monospace;
    }
    
    .payment-note {
      font-size: 14px;
      color: rgba(255,255,255,0.8);
      margin-top: 15px;
    }
    
    .copy-btn {
      background: var(--mlbb-gold);
      color: var(--mlbb-dark);
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
      transition: all 0.3s;
    }
    
    .copy-btn:hover {
      background: #ffea00;
      transform: translateY(-2px);
    }
    
    .qr-container {
      text-align: center;
      margin: 20px 0;
    }
    
    .qr-code {
      max-width: 250px;
      border: 3px solid var(--mlbb-gold);
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .verification-container {
      background: rgba(0,0,0,0.3);
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 4px solid var(--mlbb-gold);
    }
    
    .verify-btn {
      background: var(--mlbb-gold);
      color: var(--mlbb-dark);
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
      display: inline-block;
    }
    
    .verification-status {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
      display: none;
    }
    
    .success {
      background: rgba(46, 204, 113, 0.2);
      border: 1px solid var(--success-green);
      color: var(--success-green);
    }
    
    .error {
      background: rgba(231, 76, 60, 0.2);
      border: 1px solid var(--error-red);
      color: var(--error-red);
    }
    
    .section-title {
      font-size: 24px;
      color: var(--mlbb-gold);
      margin: 30px 0 15px;
      text-align: center;
      position: relative;
    }
    
    .section-title:after {
      content: "";
      display: block;
      width: 100px;
      height: 3px;
      background: var(--mlbb-red);
      margin: 10px auto;
    }
    
    .bonus-title {
      color: var(--bonus-green);
    }
    
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .product-card {
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .bonus-card {
      border: 1px solid var(--bonus-green);
      box-shadow: 0 0 15px rgba(46, 204, 113, 0.2);
    }
    
    .Weekly-card {
      border: 1px solid var(--mlbb-gold);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
    }
    
    .recommended-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--mlbb-red);
      color: white;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
    }
    
    .Weekly-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--mlbb-gold);
      color: var(--mlbb-dark);
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
    }
    
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }
    
    .diamond-count {
      font-size: 28px;
      font-weight: bold;
      color: var(--diamond-blue);
      margin: 10px 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .bonus-diamond-count {
      color: var(--bonus-green);
    }
    
    .Weekly-count {
      color: var(--mlbb-gold);
    }
    
    .diamond-count:before {
      content: "üíé";
      margin-right: 8px;
      font-size: 24px;
    }
    
    .Weekly-count:before {
      content: "‚ú®";
      margin-right: 8px;
      font-size: 24px;
    }
    
    .price {
      font-size: 22px;
      color: var(--mlbb-gold);
      text-align: center;
      margin: 15px 0;
    }
    
    .bonus-price {
      color: var(--bonus-green);
    }
    
    .processing-time {
      font-size: 14px;
      color: rgba(255,255,255,0.7);
      text-align: center;
      margin-top: 10px;
    }
    
    .quantity-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 15px 0;
    }
    
    .quantity-btn {
      background: var(--mlbb-dark);
      color: white;
      border: 1px solid var(--mlbb-gold);
      width: 30px;
      height: 30px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 4px;
    }
    
    .quantity-input {
      width: 50px;
      text-align: center;
      margin: 0 10px;
      padding: 5px;
      background: rgba(255,255,255,0.1);
      border: 1px solid var(--mlbb-gold);
      color: white;
      border-radius: 4px;
    }
    
    .max-notice {
      font-size: 12px;
      color: var(--mlbb-gold);
      text-align: center;
      margin-top: 5px;
    }
    
    .order-btn {
      background: var(--whatsapp-green);
      color: white;
      border: none;
      padding: 12px;
      border-radius: 6px;
      width: 100%;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .order-btn:hover {
      background: #128C7E;
    }
    
    .order-btn:before {
      content: "";
      display: inline-block;
      width: 20px;
      height: 20px;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>');
      margin-right: 8px;
    }
    
    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    
    .popup-box {
      background: linear-gradient(135deg, #1A1A2E, #16213E);
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      border: 1px solid var(--mlbb-red);
      box-shadow: 0 0 20px rgba(255,70,85,0.3);
    }
    
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      cursor: pointer;
      color: var(--mlbb-gold);
    }
    
    .form-input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 6px;
      color: white;
      font-size: 16px;
    }
    
    .form-input::placeholder {
      color: rgba(255,255,255,0.5);
    }
    
    .file-upload {
      margin: 15px 0;
      text-align: center;
    }
    
    .file-upload-label {
      display: block;
      padding: 12px;
      background: rgba(255,255,255,0.1);
      border: 1px dashed rgba(255,255,255,0.3);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .file-upload-label:hover {
      background: rgba(255,255,255,0.2);
    }
    
    .file-name {
      font-size: 12px;
      margin-top: 5px;
      color: var(--mlbb-gold);
      word-break: break-all;
    }
    
    #payment-ss {
      display: none;
    }
    
    .server-hint {
      font-size: 12px;
      color: rgba(255,255,255,0.6);
      text-align: center;
      margin-top: 5px;
    }
    
    .error {
      border-color: #FF4655 !important;
    }
    
    .error-message {
      color: #FF4655;
      font-size: 12px;
      display: none;
      margin-top: 5px;
    }
    
    .form-title {
      text-align: center;
      margin-bottom: 20px;
      color: var(--mlbb-gold);
      font-size: 20px;
    }
    
    /* Verification Popup Styles */
    .verification-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .verification-box {
      background: linear-gradient(135deg, #1A1A2E, #16213E);
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      border: 2px solid var(--mlbb-gold);
      box-shadow: 0 0 25px rgba(255,215,0,0.4);
      position: relative;
    }
    
    .verification-title {
      color: var(--mlbb-gold);
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
    }
    
    .verification-content {
      margin-bottom: 20px;
    }
    
    .verification-row {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      padding: 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 6px;
    }
    
    .verification-label {
      color: var(--mlbb-gold);
      font-weight: bold;
    }
    
    .verification-value {
      color: white;
      text-align: right;
    }
    
    .verification-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 25px;
    }
    
    .verify-confirm-btn {
      background: var(--success-green);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      flex: 1;
      margin-right: 10px;
    }
    
    .verify-cancel-btn {
      background: var(--error-red);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      flex: 1;
      margin-left: 10px;
    }
    
    .verification-note {
      font-size: 13px;
      color: rgba(255,255,255,0.7);
      text-align: center;
      margin-top: 20px;
      font-style: italic;
    }
    
    .verification-highlight {
      color: var(--mlbb-gold);
      font-weight: bold;
    }
    
    /* Auth Modal Styles */
    #auth-modal .popup-box {
      max-width: 350px;
    }
    
    #auth-modal .order-btn {
      margin-top: 15px;
    }
    
    #auth-modal p {
      color: rgba(255,255,255,0.8);
    }
    
    #auth-modal a {
      text-decoration: none;
    }
    
    @media (max-width: 768px) {
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      }
      
      .logo-img {
        max-width: 150px;
      }
      
      .store-title {
        font-size: 2rem;
      }
      
      .verification-buttons {
        flex-direction: column;
      }
      
      .verify-confirm-btn, .verify-cancel-btn {
        margin: 5px 0;
        width: 100%;
      }
      
      #auth-section {
        margin: 10px 5px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Auth Section -->
    <div id="auth-section">
      <button id="auth-btn">Login/Signup</button>
      <div id="user-profile">
        <span id="username-display"></span>
        <button id="logout-btn">Logout</button>
      </div>
    </div>

    <!-- Store Logo and Title -->
    <div class="logo-container">
      <img src="https://i.ibb.co/TxRTR7gK/Screenshot-2025-07-02-093146.png" 
           alt="P&K Store Logo" 
           class="logo-img">
    </div>
    <h1 class="store-title">P&K Store</h1>
    
    <header>
      <h2>üéó ùôºùôªùô±ùô± ùô≥ùô∏ùô∞ùôºùôæùôΩùô≥ ùô∏ùô≥ & ùöÇùô¥ùöÅùöÖùô¥ùöÅ üéó</h2>
      <p>Fast and reliable diamond top-up service</p>
    </header>
    
    <!-- Payment Information Section -->
    <div class="payment-info">
      <div class="upi-container">
        <div>Scan QR Code or Use UPI ID:</div>
        <div class="upi-id">BHARATPE.8R0E0I8U2N09755@fbpe</div>
        <button class="copy-btn" onclick="copyUPI()">Copy UPI ID</button>
        
        <!-- Real Payment QR Code -->
        <div class="qr-container">
          <img src="https://i.ibb.co/Ng8QNzV9/Whats-App-Image-2025-07-02-at-09-13-44-998097fb.jpg" 
               alt="Scan to Pay via BharatPe" 
               class="qr-code">
        </div>
        
        <!-- Verification Sample -->
        <div class="verification-container">
          <h4>Payment Verification Sample</h4>
          <img src="https://i.ibb.co/vvhQ3PP3/Whats-App-Image-2025-07-02-at-09-17-02-4e90a5e6.jpg" 
               alt="Payment Verification Sample" 
               style="max-width: 250px; border: 2px solid var(--mlbb-gold); border-radius: 8px; margin: 10px auto;">
          <p style="font-size: 14px; color: rgba(255,255,255,0.7);">Please include your UPI transaction ID in the screenshot like shown above</p>
        </div>
        
        <div class="payment-note">
          Accepts: Paytm, Google Pay, PhonePe, BHIM, and all UPI apps<br>
          Screenshot payment confirmation for order processing
        </div>
      </div>
    </div>
    
    <!-- DOUBLE BONUS SECTION -->
    <div class="section-title bonus-title">ùô≥ùôæùöÑùô±ùôªùô¥ ùô±ùôæùôΩùöÑùöÇ ùöÅùô¥ùô≤ùô∑ùô∞ùöÅùô∂ùô¥</div>
    <div class="products-grid">
      <div class="product-card bonus-card">
        <div class="diamond-count bonus-diamond-count">50+50</div>
        <div class="price bonus-price">‚Çπ 80</div>
        <div class="processing-time">Via ID processing: 2-3 minutes</div>
        <button class="order-btn" data-product="50+50 Diamonds (Double Bonus)" data-price="80">Order Now</button>
      </div>
      
      <div class="product-card bonus-card">
        <div class="diamond-count bonus-diamond-count">150+150</div>
        <div class="price bonus-price">‚Çπ 260</div>
        <div class="processing-time">Via ID processing: 2-3 minutes</div>
        <button class="order-btn" data-product="150+150 Diamonds (Double Bonus)" data-price="260">Order Now</button>
      </div>
      
      <div class="product-card bonus-card">
        <div class="diamond-count bonus-diamond-count">250+250</div>
        <div class="price bonus-price">‚Çπ 370</div>
        <div class="processing-time">Via ID processing: 2-3 minutes</div>
        <button class="order-btn" data-product="250+250 Diamonds (Double Bonus)" data-price="370">Order Now</button>
      </div>
      
      <div class="product-card bonus-card">
        <div class="diamond-count bonus-diamond-count">500+500</div>
        <div class="price bonus-price">‚Çπ 680</div>
        <div class="processing-time">Via ID processing: 2-3 minutes</div>
        <div class="recommended-badge">Recommended</div>
        <button class="order-btn" data-product="500+500 Diamonds (Double Bonus)" data-price="680">Order Now</button>
      </div>
    </div>
    
    <!-- WEEKLY PASS -->
    <div class="section-title">WEEKLY ùôøùô∞ùöÇùöÇ</div>
    <div class="products-grid">
      <div class="product-card Weekly-card">
        <div class="Weekly-badge">VIP</div>
        <div class="diamond-count Weekly-count">Weekly Pass</div>
        <div class="price">‚Çπ 130 <span style="font-size:14px">each</span></div>
        
        <div class="quantity-controls">
          <button class="quantity-btn" onclick="adjustQuantity('Weekly', -1)">-</button>
          <input type="number" id="Weekly-qty" class="quantity-input" value="1" min="1" max="10">
          <button class="quantity-btn" onclick="adjustQuantity('Weekly', 1)">+</button>
        </div>
        <div class="max-notice">(Max 10 per order)</div>
        
        <button class="order-btn" onclick="orderWeekly()">Order Now</button>
      </div>
    </div>
    
    <!-- REGULAR DIAMOND PACKS -->
    <div class="section-title">ùöÅùô¥ùô∂ùöÑùôªùô∞ùöÅ ùô≥ùô∏ùô∞ùôºùôæùôΩùô≥ùöÇ</div>
    <div class="products-grid">
      <!-- Your existing product cards (update buttons with data attributes) -->
      <div class="product-card">
        <div class="diamond-count">11</div>
        <div class="price">‚Çπ 25</div>
        <button class="order-btn" data-product="11 Diamonds" data-price="25">Order Now</button>
      </div>
      
      <!-- More product cards... -->
    </div>
  </div>
  
  <!-- Auth Modal -->
  <div id="auth-modal" class="popup-overlay">
    <div class="popup-box">
      <span class="close-btn" onclick="closeAuthModal()">√ó</span>
      <div class="form-title">Account</div>
      
      <div id="login-form">
        <input type="email" id="login-email" class="form-input" placeholder="Email" required>
        <input type="password" id="login-password" class="form-input" placeholder="Password" required>
        <button onclick="handleLogin()" class="order-btn">Login</button>
        <p style="text-align: center; margin-top: 15px;">
          New user? <a href="#" onclick="showSignupForm()" style="color: var(--mlbb-gold); cursor: pointer;">Create account</a>
        </p>
      </div>
      
      <div id="signup-form" style="display: none;">
        <input type="text" id="signup-username" class="form-input" placeholder="Username" required>
        <input type="email" id="signup-email" class="form-input" placeholder="Email" required>
        <input type="tel" id="signup-phone" class="form-input" placeholder="Phone Number" required>
        <input type="password" id="signup-password" class="form-input" placeholder="Password" required>
        <button onclick="handleSignup()" class="order-btn">Sign Up</button>
        <p style="text-align: center; margin-top: 15px;">
          Already have an account? <a href="#" onclick="showLoginForm()" style="color: var(--mlbb-gold); cursor: pointer;">Login</a>
        </p>
      </div>
    </div>
  </div>
  
  <!-- Verification Before Payment Popup -->
  <div id="verification-popup" class="verification-popup">
    <div class="verification-box">
      <div class="verification-title">‚ö†Ô∏è PLEASE VERIFY YOUR ORDER</div>
      <div class="verification-content">
        <div class="verification-row">
          <span class="verification-label">Product:</span>
          <span class="verification-value" id="verify-product">86 Diamonds</span>
        </div>
        <div class="verification-row">
          <span class="verification-label">Amount to Pay:</span>
          <span class="verification-value" id="verify-price">‚Çπ 115</span>
        </div>
        <div class="verification-row">
          <span class="verification-label">Payment Method:</span>
          <span class="verification-value">UPI (BHARATPE.8R0E0I8U2N09755@fbpe)</span>
        </div>
      </div>
      
      <div class="verification-note">
        <span class="verification-highlight">Important:</span> Please double-check all details before proceeding to payment. 
        We cannot refund payments sent to wrong UPI ID.
      </div>
      
      <div class="verification-buttons">
        <button class="verify-confirm-btn" onclick="proceedToPayment()">‚úÖ Confirm & Proceed</button>
        <button class="verify-cancel-btn" onclick="closeVerification()">‚úñÔ∏è Cancel</button>
      </div>
    </div>
  </div>
  
  <!-- Order Popup -->
  <div id="popup" class="popup-overlay">
    <div class="popup-box">
      <span class="close-btn" onclick="closePopup()">√ó</span>
      <div class="form-title">Complete Your Order</div>
      <form id="order-form" onsubmit="processOrder(event)">
        <input type="hidden" id="product-name">
        <input type="hidden" id="product-price">
        
        <input type="text" id="uid" class="form-input" placeholder="Your MLBB ID (Numbers only)" required>
        
        <input type="text" id="server" class="form-input" 
               placeholder="Server ID (Numbers only)" 
               pattern="\d+" 
               title="Enter server numbers only"
               required>
        
        <input type="text" id="ign" class="form-input" 
               placeholder="In-Game Name (IGN)" 
               required>
        
        <div class="file-upload">
          <label for="payment-ss" class="file-upload-label">
            üì∏ Upload Payment Screenshot (Required)
          </label>
          <input type="file" id="payment-ss" accept="image/*" required>
          <div id="file-name" class="file-name"></div>
        </div>
        
        <div class="payment-note" style="text-align: center; margin-top: 10px;">
          Paid to: <strong>BHARATPE.8R0E0I8U2N09755@fbpe</strong>
        </div>
        
        <button type="submit" class="order-btn">
          Send via WhatsApp
        </button>
      </form>
    </div>
  </div>

  <script>
    // API Configuration
    const API_BASE = 'https://mlbb-auth-api.azurewebsites.net/api/auth';
    let currentUser = null;
    let currentProduct = '';
    let currentPrice = '';

    // DOM Elements
    const authBtn = document.getElementById('auth-btn');
    const userProfile = document.getElementById('user-profile');
    const usernameDisplay = document.getElementById('username-display');
    const logoutBtn = document.getElementById('logout-btn');

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      checkAuth();
      setupOrderButtons();
    });

    // Auth Modal Functions
    function openAuthModal() {
      document.getElementById('auth-modal').style.display = 'flex';
      showLoginForm();
    }

    function closeAuthModal() {
      document.getElementById('auth-modal').style.display = 'none';
    }

    function showLoginForm() {
      document.getElementById('login-form').style.display = 'block';
      document.getElementById('signup-form').style.display = 'none';
    }

    function showSignupForm() {
      document.getElementById('login-form').style.display = 'none';
      document.getElementById('signup-form').style.display = 'block';
    }

    // Auth Event Listeners
    authBtn.addEventListener('click', openAuthModal);
    logoutBtn.addEventListener('click', handleLogout);

    // Auth Handlers
    async function handleLogin() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      try {
        const response = await fetch(`${API_BASE}/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        const data = await response.json();
        
        if (response.ok) {
          localStorage.setItem('authToken', data.token);
          currentUser = data.user;
          updateAuthUI();
          closeAuthModal();
        } else {
          alert(data.error || 'Login failed');
        }
      } catch (error) {
        alert('Error during login. Please try again.');
      }
    }

    async function handleSignup() {
      const userData = {
        username: document.getElementById('signup-username').value,
        email: document.getElementById('signup-email').value,
        phone: document.getElementById('signup-phone').value,
        password: document.getElementById('signup-password').value
      };

      try {
        const response = await fetch(`${API_BASE}/signup`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(userData)
        });

        const data = await response.json();
        
        if (response.ok) {
          localStorage.setItem('authToken', data.token);
          currentUser = data.user;
          updateAuthUI();
          closeAuthModal();
          alert('Account created successfully!');
        } else {
          alert(data.error || 'Signup failed');
        }
      } catch (error) {
        alert('Error during signup. Please try again.');
      }
    }

    async function handleLogout() {
      localStorage.removeItem('authToken');
      currentUser = null;
      updateAuthUI();
      alert('You have been logged out.');
    }

    async function checkAuth() {
      const token = localStorage.getItem('authToken');
      if (!token) return;

      try {
        const response = await fetch(`${API_BASE}/me`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });

        if (response.ok) {
          currentUser = await response.json();
          updateAuthUI();
        }
      } catch (error) {
        console.error('Auth check failed:', error);
      }
    }

    function updateAuthUI() {
      if (currentUser) {
        authBtn.style.display = 'none';
        userProfile.style.display = 'block';
        usernameDisplay.textContent = currentUser.username;
      } else {
        authBtn.style.display = 'block';
        userProfile.style.display = 'none';
      }
    }

    function setupOrderButtons() {
      document.querySelectorAll('.order-btn').forEach(btn => {
        if (btn.onclick) return; // Skip if already has click handler
        
        btn.addEventListener('click', function() {
          const product = this.getAttribute('data-product');
          const price = this.getAttribute('data-price');
          verifyBeforePayment(product, price);
        });
      });
    }

    // Existing order functionality
    function verifyBeforePayment(product, price) {
      if (!currentUser) {
        alert('Please login to place an order');
        openAuthModal();
        return;
      }
      
      currentProduct = product;
      currentPrice = price;
      
      document.getElementById('verify-product').textContent = product;
      document.getElementById('verify-price').textContent = `‚Çπ ${price}`;
      document.getElementById('verification-popup').style.display = 'flex';
    }
    
    function closeVerification() {
      document.getElementById('verification-popup').style.display = 'none';
    }
    
    function proceedToPayment() {
      closeVerification();
      openPopup(currentProduct, currentPrice);
      
      document.querySelector('.payment-info').scrollIntoView({
        behavior: 'smooth'
      });
    }

    // UPI Copy Function
    function copyUPI() {
      const upiId = "BHARATPE.8R0E0I8U2N09755@fbpe";
      navigator.clipboard.writeText(upiId).then(() => {
        alert("UPI ID copied to clipboard: " + upiId);
      }).catch(err => {
        console.error("Failed to copy: ", err);
      });
    }

    // File upload display
    document.getElementById('payment-ss').addEventListener('change', function(e) {
      const fileName = e.target.files[0]?.name || 'No file selected';
      document.getElementById('file-name').textContent = fileName;
    });

    // Quantity Control for Weekly Pass
    function adjustQuantity(type, change) {
      const input = document.getElementById(`${type}-qty`);
      let newVal = parseInt(input.value) + change;
      newVal = Math.max(1, Math.min(10, newVal));
      input.value = newVal;
    }
    
    function orderWeekly() {
      const quantity = parseInt(document.getElementById("Weekly-qty").value);
      const totalPrice = 130 * quantity;
      verifyBeforePayment(
        `${quantity} Weekly Pass${quantity > 1 ? 'es' : ''}`, 
        totalPrice
      );
    }
    
    // Popup Functions
    function openPopup(productName, price) {
      document.getElementById("product-name").value = productName;
      document.getElementById("product-price").value = price;
      document.getElementById("popup").style.display = "flex";
      document.getElementById("file-name").textContent = "";
      document.getElementById("order-form").reset();
    }
    
    function closePopup() {
      document.getElementById("popup").style.display = "none";
    }
    
    // Server ID Validation
    document.getElementById('server').addEventListener('input', function() {
      const serverInput = this;
      const errorElement = document.getElementById('server-error');
      
      if(/\D/.test(serverInput.value)) {
        serverInput.classList.add('error');
        errorElement.style.display = 'block';
      } else {
        serverInput.classList.remove('error');
        errorElement.style.display = 'none';
      }
    });

    // WhatsApp Order Function
    function processOrder(e) {
      e.preventDefault();
      
      const serverInput = document.getElementById('server');
      if(/\D/.test(serverInput.value)) {
        serverInput.classList.add('error');
        return false;
      }
      
      const product = document.getElementById("product-name").value;
      const price = document.getElementById("product-price").value;
      const uid = document.getElementById("uid").value;
      const server = serverInput.value;
      const ign = document.getElementById("ign").value;
      const yourNumber = "9362584929"; // YOUR WhatsApp number
      
      const message = `*MLBB TOP-UP ORDER*%0A%0A` +
                     `üì¶ Product: ${product}%0A` +
                     `üíµ Amount Paid: ‚Çπ${price}%0A` +
                     `üì± Paid to: BHARATPE.8R0E0I8U2N09755@fbpe%0A%0A` +
                     `üë§ Player Details:%0A` +
                     `üÜî ID: ${uid}%0A` +
                     `üåê Server ID: ${server}%0A` +
                     `üè∑Ô∏è IGN: ${ign}%0A%0A` +
                     `üì∏ Payment screenshot attached below`;
      
      window.open(`https://wa.me/${yourNumber}?text=${message}`, "_blank");
      closePopup();
      
      alert("Please send the payment screenshot in the WhatsApp chat that opened.");
    }
  </script>
</body>
</html>
